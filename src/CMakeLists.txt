
message("python path : ${PYTHON_INCLUDE_PATH}")

INCLUDE_DIRECTORIES("${Boost_INCLUDE_DIRS}"
    ${PYTHON_INCLUDE_PATH}  ${GLIB2_INCLUDE_DIRS} ${GTHREAD2_INCLUDE_DIRS}
    ${GFAL2_INCLUDE_DIRS}
)

FILE(GLOB src_python "*.cpp")

SET(Boost_USE_STATIC_LIBS OFF)
SET(Boost_USE_MULTITHREADED ON)
SET(Boost_USE_STATIC_RUNTIME OFF)

link_directories (
    ${GLIB2_LIBRARY_DIRS}
    ${GFAL2_LIBRARY_DIRS}
)

ADD_LIBRARY(gfal-py MODULE ${src_python} )
TARGET_LINK_LIBRARIES(gfal-py
    ${Boost_LIBRARIES} ${GLIB2_LIBRARIES}  ${GTHREAD2_LIBRARIES}
    ${GFAL2_LIBRARIES} ${PYTHON_LIBRARIES}
)


set_target_properties(gfal-py
    PROPERTIES
        CLEAN_DIRECT_OUTPUT 1
        PREFIX ""
        OUTPUT_NAME ${OUTPUT_NAME_MAIN}
)


install(TARGETS gfal-py 
	    RUNTIME		DESTINATION ${CMAKE_INSTALL_PREFIX}
	    LIBRARY		DESTINATION ${PYTHON_SITE_PACKAGES} )
